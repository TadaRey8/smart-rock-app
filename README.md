要件定義ドキュメント

1. プロジェクト概要

プロジェクト名: smart-rock-app

作成日: 2025-04-19

目的: WebアプリでRaspberry Piに接続したサーボモーターを動かし、ドアの鍵を開閉する

2. 利用者・役割

エンドユーザー: スマートフォンから操作する利用者

管理者: 有り（システムの初期設定やユーザー管理を行う担当者）

利用シナリオ: スマートフォンで部屋のドアの鍵を開閉する

3. ハードウェア構成

Raspberry Piモデル: Raspberry Pi Pico W

OS: MicroPython (Python 3をRP2040上で実装した組み込み向けファームウェア) (raspberrypi.com)

サーボモーター: TowerPro SG90（9gマイクロサーボ）

動作電圧: 4.8～6.0 V DC (jsumo.com)

ストールトルク: 1.8 kg·cm (4.8 V時) (friendlywire.com)

動作速度: 0.1 s/60° (4.8 V時) (friendlywire.com)

寸法: 約22.2×11.8×31 mm (friendlywire.com)

ドアロック仕様: 指で回すタイプのノブ錠

錠形式: 回転式ノブ（メカニカルシリンダー式）

接続方法: ノブ部分に3Dプリンターで製作したアダプタを介し、サーボモーターと直結

必要トルク: SG90（1.8 kg·cm以上）で対応可能



4. 機能要件

4.1 Web UI

ボタン: 施錠（Lock）、開錠（Unlock）

ステータス表示: 現在の鍵状態（Locked/Unlocked）

レスポンスタイム: <500ms

4.2 APIエンドポイント

POST /lock: 施錠を実行

POST /unlock: 開錠を実行

GET /status: 鍵状態を取得

認証: Basic Auth over HTTPS

5. 非機能要件

同時接続数: 最大1接続

可用性: 99%稼働

レスポンス時間（非機能）: 平均<300ms

ロギング: 操作履歴とエラーログをファイルに保存

エラーハンドリング: 通信やサーボ制御失敗時のリトライと通知

ファームウェア更新: OTA／USB経由でのPythonスクリプト更新機能

6. 運用・保守要件

バックアップ: 設定情報の定期バックアップ

モニタリング: サービス稼働状況を監視し、障害検知時に管理者へ通知

ドキュメント: インストール手順・運用手順書の整備

7. セキュリティ要件

TLS証明書自動更新: Let’s EncryptのACME利用

ファームウェア署名検証: 不正改ざん防止

ネットワーク隔離: VLANやファイアウォールによるアクセス制御

8. テスト要件

単体テスト: 各APIエンドポイントの挙動検証

結合テスト: Web UIと制御サービス間の動作確認

負荷テスト: 想定同時接続時のレスポンス評価

以上の要件を追加すると、開発から運用までの品質と安全性がより担保されます。必要なければ、次の設計フェーズに進みましょう！